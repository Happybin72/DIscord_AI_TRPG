## 1. 핵심 목표

유저가 디스코드에서 자유롭게 TRPG를 즐길 수 있음

LLM 호출량이 제한적이므로 토큰/호출량 관리 기능 포함

TRPG의 세계관과 설정을 미리 정의·저장하고, 게임 진행 중 참조 가능

LLM은 스토리, 이벤트, NPC 반응 생성에 활용

## 2. 게임 구조
### A. 유저 인터랙션

디스코드 명령어 / 버튼 / 선택지

텍스트 입력(자유로운 행동, 감정 선택)

봇이 유저 입력을 파싱 → 게임 상태 업데이트

LLM 호출 여부 결정

이벤트/대사 생성 시만 호출

호출 시 토큰/사용량 알람 표시

결과 출력: 스토리, NPC 대사, 상태 변화, 선택지 버튼

### B. TRPG 세계관 설계

세계관, 캐릭터, 주요 퀘스트, 아이템, 스킬 등을 사전 정의

구현 방법:

LLM 초기 프롬프트로 입력

"당신은 다음 TRPG 세계관의 게임 마스터 역할을 맡습니다.
 - 세계관: 판타지 대륙 ‘루나리아’, 3개의 주요 도시, 5종족
 - 주요 NPC: ... 
 - 규칙: HP, MP, 감정치 기반 이벤트
 - 퀘스트: ... "


봇은 이 초기 설정을 기억하고, 유저 요청 시 LLM 호출 시마다 참고

추가 가능: 설정 업데이트 명령어를 통해 유저가 세계관 확장

### C. 토큰 사용량 관리

LLM 호출 시마다 토큰 소모 추적

유저별 / 전체 서버별 호출량 집계

디스코드 알람 예시:

“이번 세션에서 LLM 호출 가능량이 30% 남았습니다”

“무료 LLM 한도를 초과했습니다. 다음 이벤트는 사전 생성된 콘텐츠로 진행됩니다”

사전 캐싱: 반복되는 NPC 대사·퀘스트는 미리 생성 후 로컬 DB 저장

### D. 게임 루프 예시
[유저 입력] → [봇 파싱] → [토큰 체크]
      ↓
   LLM 호출 필요?
      ├ Yes → LLM 호출 → 이벤트/대사 생성
      └ No  → 캐싱된 이벤트/규칙 기반 출력
      ↓
[게임 상태 업데이트] → [디스코드 출력]
      ↓
[유저 선택/행동] → 반복

## 3. 추가 기능

세계관 확장 기능

유저가 새로운 퀘스트/장소/NPC 제안 → 봇이 세계관에 통합

LLM이 요약·정리하여 사전 데이터로 저장

감정 기반 힐링 요소

유저 입력 감정을 스탯/이벤트 결과에 반영

힐링 메시지·아이템·환경 변화

SNS 공유

게임 내 이벤트, 캐릭터 성장, 희귀 아이템 획득 결과 → 이미지/텍스트 자동 생성

“오늘의 모험 기록” 스크린샷 공유

## 4. 기술 스택
역할	기술/툴
디스코드 봇	discord.py / discord.js
무료 LLM	GEminai 2.5 Flash (로컬 실행)
상태/세계관 저장	SQLite / Redis
이벤트·대사 캐싱	JSON / DB
이미지 생성(선택)	Stable Diffusion / 로컬 모델
토큰/호출량 관리	서버 변수 + 알람 메시지

💡 핵심 포인트

유저가 세계관과 상호작용 가능: 단순 텍스트 입력 이상으로 “TRPG 세계에서 행동”하는 느낌 제공

LLM 호출 최소화 + 캐싱: 무료 LLM 한도 내에서 운영 가능

게임성 강화: 스탯·퀘스트·선택지 시스템 + 감정 기반 이벤트

## 5. 업데이트 예정 ( 25.8.14 )
- 이미지 및 음악 업데이트 기능
- 유저의 정보, 스토리 중간 요약을 기억하는 DB 구축
